## Improved lite-shell README.md (generated by Gemini)

**lite-shell**

A lightweight and customizable command shell for Windows.

**Building**

*Requires a C++17 compiler on Windows.*

To build the source code, run the provided batch script:

```bash
scripts/build.bat
```

This script creates the `build` directory containing the executable `shell.exe`.

**Running Tests**

The tests are written in Python and require the `pytest` library ([https://docs.pytest.org/en/7.1.x/contents.html](https://docs.pytest.org/en/7.1.x/contents.html)). We recommend creating a virtual environment for testing:

```bash
python3 -m venv .venv
source .venv/bin/activate  # Activate the virtual environment (Windows)
pip install -r requirements.txt
```

Run the tests with:

```bash
pytest .  # For basic output
pytest -v .  # For more verbose output
```

**Adding a Custom Command**

This guide demonstrates how to quickly add a new command to the shell. We'll create a command named `add` that calculates the sum of two numbers. The command should behave like this:

```
add 4 5
# Output: 9
```

**Important Note:**

* Commands run in the main process by default. 
* To isolate execution in a subprocess, create a separate executable file (using `int main(int argc, const char *argv[])`) within the `src/external` directory.

**Steps:**

1. **Create a Command File:**

   - Navigate to `src/commands`.
   - Create a new file named `add.hpp` (or any name ending with `.hpp`).

   Paste the following code:

   ```c++
   #pragma once

   #include <base.hpp>

   class AddCommand : public BaseCommand {
   public:
       AddCommand() : BaseCommand("add", "Add 2 numbers", "", {}, ArgumentsConstraint(3, 3)) {}

       DWORD run(const Context &context) override {
           // Implement command logic here
           return 0;
       }
   };
   ```

   - **Explanation:**
     - `#pragma once` ensures the header is included only once.
     - `#include <base.hpp>` includes the `BaseCommand` class definition (all commands inherit from this).
     - The constructor initializes the command's attributes:
       - Name: `add`
       - Help: `Add 2 numbers` (displayed with `help` or `help add`)
       - Description: (empty string for simplicity)
       - Aliases: `{}` (no aliases)
       - Arguments: `ArgumentsConstraint(3, 3)` (requires exactly 3 arguments)
     - The `run` method (overridden from `BaseCommand`) is the core of the command. It takes a `Context` object and returns a `DWORD` (integer) value. A return value of `0` typically indicates success.

2. **Register the Command:**

   - Navigate to `src/initialize.hpp`.
   - Include the `add.hpp` file with `#include "commands/add.hpp"`.
   - In the `initialize(Client *client)` function, add the command using:

   ```c++
   client->add_command(std::make_shared<AddCommand>());
   ```

3. **Implement the Command Logic:**

   - Back in `add.hpp`, modify the `run` method to perform the calculation:

   ```c++
   DWORD run(const Context &context) override {
       auto first = std::stoll(context.args[1]);
       auto second = std::stoll(context.args[2]);

       std::cout << first + second << std::endl;

       return 0;
   }
   ```

   - **Explanation:**
     - `context.args` is a vector containing the command arguments (including the command name).
     - `std::stoll` converts the second and third arguments (`context.args[1]` and `context.args[2]`) from strings to integer values (`long long`).
     - The sum is calculated and printed to the console (`std::cout`).

**Build and Test**

1. Run `scripts/build.bat` to rebuild the shell.
2. Start the shell and test the `add` command:

   ```
   add 4 5
   # Output: 9
   ```

**Additional Notes**

* This guide provides a basic example. Refer to the `BaseCommand` class and existing commands for more advanced features.
* Consider adding error handling (e.g., invalid arguments) to your custom commands.
